---
description: DataTable components pattern
alwaysApply: true
---
# DataTable Components

## Overview

The store admin tables feature (`client-table.tsx`, `edit-table-dialog.tsx`, `bulk-add-tables-dialog.tsx`, `cell-action.tsx`) is the canonical reference for our interactive data tables. It demonstrates the full pattern for wiring `@/components/dataTable` (and related helpers) with TanStack Table, safe actions, client-side state, and controlled dialogs. The FAQ category screen remains a secondary example that focuses on filtering-heavy tables.

## Available Components

### 1. `DataTable` (standard view)

- Base component showing the FAQ category list.
- Used for read-only listings with action columns.

### 2. `DataTableCheckbox`

- Used when the user needs to select multiple rows (e.g., assign templates).
- Provides bulk actions and select-all behavior.

### 3. Supporting helpers

- **`DataTableColumnHeader`** for sortable headers with icons.
- **`DataTablePagination`** when lists exceed default page size.
- **`DataTableViewOptions`** for toggling column visibility (optional).

## Import Pattern

All table components are local to the repo and live in `@/components`. Never import from external packages like `mingster.backbone`.

```tsx
import { DataTable } from "@/components/dataTable";
import { DataTableCheckbox } from "@/components/dataTable-checkbox";
import { DataTableColumnHeader } from "@/components/dataTable-column-header";
// Optional extras used in other screens
import { DataTablePagination } from "@/components/dataTable-pagination";
import { DataTableViewOptions } from "@/components/dataTable-view-options";
```

## Basic Usage

### Standard listing

`client-table.tsx` loads store tables from props, keeps them in local state, and renders `DataTable` with per-row actions. Key elements:

```tsx
const tableColumns: ColumnDef<TableRow>[] = [
  {
    accessorKey: "tableName",
    header: ({ column }) => (
      <DataTableColumnHeader
        column={column}
        title={t("StoreTable_Name")}
      />
    ),
  },
  {
    accessorKey: "capacity",
    header: ({ column }) => (
      <DataTableColumnHeader
        column={column}
        title={t("StoreTable_Seats")}
      />
    ),
  },
  {
    id: "actions",
    cell: ({ row }) => (
      <CellAction item={row.original} onDelete={handleDeleted} />
    ),
  },
];

return (
  <DataTable<TableRow>
    data={data}
    columns={tableColumns}
    searchKey="tableName"
  />
);
```

### With row selection

The template picker in the same module demonstrates `DataTableCheckbox` with bulk actions:

```tsx
<DataTableCheckbox
  columns={templateColumns}
  data={templateOptions}
  initiallySelected={initialSelection}
  onRowSelectionChange={setSelectedTemplates}
/>
```

Bulk actions run inside a handler that iterates `selectedTemplates` and call server actions (or axios endpoints) before updating local state.

## Column Definition Patterns

### Basic Column

```tsx
{
  accessorKey: "name",
  header: "Name",
}
```

### Sortable Column

```tsx
{
  accessorKey: "name",
  header: ({ column }) => (
    <DataTableColumnHeader column={column} title="Name" />
  ),
}
```

### Custom cell rendering

```tsx
{
  accessorKey: "status",
  header: "Status",
  cell: ({ row }) => {
    const status = row.getValue("status") as string;
    return (
      <Badge variant={status === "active" ? "success" : "default"}>
        {status}
      </Badge>
    );
  },
}
```

### Actions column pattern

```tsx
{
  id: "actions",
  cell: ({ row }) => (
    <DropdownMenu>
      <DropdownMenuTrigger asChild>
        <Button variant="ghost" size="icon">
          <IconDots />
        </Button>
      </DropdownMenuTrigger>
      <DropdownMenuContent align="end">
        <DropdownMenuItem onClick={() => handleEdit(row.original)}>
          Edit
        </DropdownMenuItem>
        <DropdownMenuItem onClick={() => handleDelete(row.original)}>
          Delete
        </DropdownMenuItem>
      </DropdownMenuContent>
    </DropdownMenu>
  ),
}
```

### Hide column by default

```tsx
{
  accessorKey: "id",
  header: "ID",
  enableHiding: true,
}
```

## Props Reference

### `DataTable` props

```tsx
interface DataTableProps<TData, TValue> {
  columns: ColumnDef<TData, TValue>[];  // Column definitions
  data: TData[];                        // Table data
  searchKey?: string;                   // Key for search functionality
  noSearch?: boolean;                   // Disable search (default: false)
  rowSelectionEnabled?: boolean;        // Enable row selection
}
```

### `DataTableCheckbox` props

```tsx
interface DataTableCheckboxProps<TData> {
  columns: ColumnDef<TData>[];
  data: TData[];
  onSelectionChange?: (rows: TData[]) => void;  // Callback for selection
  searchKey?: string;
}
```

`client-faq-category.tsx` does not use `DataTableDraggable`. Follow existing product option templates or reorderable feature screens if drag/drop is required.

## Internationalization

Tables are localized via the i18n hooks (`useTranslation`). Column titles are always translated strings, passed to `DataTableColumnHeader`. Use the same approach when adding new tables.

## TypeScript

Always type your rows:

```tsx
interface TableRow {
  id: string;
  tableName: string;
  capacity: number;
  storeId: string;
}

const columns: ColumnDef<TableRow>[] = [...];
```

## Best Practices

1. **Import locally**: Always import from `@/components`.
2. **Type safety**: Define a row interface and use generics on `DataTable`.
3. **Memoize columns**: Use `useMemo` inside client components to avoid hydration differences when translations change.
4. **Stable state**: Store data in local `useState` and update via callbacks (create/update/delete) to keep UI responsive.
5. **Search/filter**: Use the `searchKey` prop plus optional custom filter components (`FilterFaqCategories` in the FAQ screen).
6. **Actions**: Keep per-row actions (`CellAction`) colocated with the table for clarity.
7. **Controlled dialogs**: When opening dialogs from dropdown menus, control the dialogâ€™s `open` state in the table row component (see tables `cell-action.tsx`) so it stays mounted.

## Common Patterns

### With Client State Management

```tsx
const [data, setData] = useState<TableRow[]>(serverTables);

// Update, create, delete handlers
const handleUpdated = (updatedUser: User) => {
  setData(prev => 
    prev.map(user => user.id === updatedUser.id ? updatedUser : user)
  );
};

<DataTable<TableRow> columns={columns} data={data} />
```

### With Filtering

```tsx
const [selectedStatus, setSelectedStatus] = useState<StatusFilter>("all");
const [searchTerm, setSearchTerm] = useState("");

const filteredData = useMemo(
  () =>
    data.filter((item) => {
      const matchesStatus =
        selectedStatus === "all" || item.status === selectedStatus;
      const matchesSearch = item.name
        .toLowerCase()
        .includes(searchTerm.toLowerCase());
      return matchesStatus && matchesSearch;
    }),
  [data, selectedStatus, searchTerm],
);

<DataTable<TableRow>
  columns={columns}
  data={filteredData}
  searchKey="tableName"
/>
```

### With Loading State

```tsx
{isLoading ? (
  <Loader />
) : (
  <DataTable<TableRow> columns={columns} data={data} />
)}
```

## Source Location

Canonical implementation:

- `web/src/app/storeAdmin/(dashboard)/[storeId]/(routes)/tables/components/client-table.tsx`
- `web/src/app/storeAdmin/(dashboard)/[storeId]/(routes)/tables/components/edit-table-dialog.tsx`
- `web/src/app/storeAdmin/(dashboard)/[storeId]/(routes)/tables/components/bulk-add-tables-dialog.tsx`
- `web/src/app/storeAdmin/(dashboard)/[storeId]/(routes)/tables/components/cell-action.tsx`
- `web/src/app/storeAdmin/(dashboard)/[storeId]/(routes)/tables/components/columns.tsx`
- `web/src/app/storeAdmin/(dashboard)/[storeId]/(routes)/faq/components/client-faq-category.tsx` (filter-focused example)
- `web/src/app/storeAdmin/(dashboard)/[storeId]/(routes)/faq/components/columns.tsx`

Shared table primitives:

- `web/src/components/dataTable.tsx`
- `web/src/components/dataTable-checkbox.tsx`
- `web/src/components/dataTable-column-header.tsx`
- `web/src/components/dataTable-pagination.tsx`
- `web/src/components/dataTable-view-options.tsx`
